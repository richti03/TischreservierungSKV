<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How-To · Tischreservierung</title>
    <link rel="icon" href="img/SKV-Wappen.jpg">
    <style>
        :root {
            color-scheme: light;
            font-family: "Segoe UI", "Helvetica Neue", Arial, sans-serif;
        }
        body {
            margin: 0;
            padding: 0;
            background: #f8fafc;
            color: #0f172a;
            line-height: 1.6;
        }
        header {
            background: royalblue;
            color: #fff;
            padding: 32px 24px 24px;
        }
        header h1 {
            margin: 0 0 12px;
            font-size: clamp(28px, 3vw, 42px);
        }
        header p {
            margin: 0;
            max-width: 720px;
        }
        main {
            max-width: 960px;
            margin: 0 auto;
            padding: 32px 24px 64px;
        }
        nav {
            background: #fff;
            border-radius: 12px;
            padding: 16px 20px;
            box-shadow: 0 10px 30px rgba(15, 23, 42, 0.12);
            margin-bottom: 32px;
        }
        nav h2 {
            margin-top: 0;
            font-size: 20px;
        }
        nav ul {
            margin: 0;
            padding-left: 20px;
            columns: 2;
            gap: 24px;
            list-style: none;
        }
        nav li::before {
            content: "›";
            color: royalblue;
            margin-right: 6px;
        }
        nav li {
            break-inside: avoid;
            margin-bottom: 8px;
        }
        nav a {
            color: royalblue;
            text-decoration: none;
        }
        nav a:hover,
        nav a:focus {
            text-decoration: underline;
        }
        section {
            margin-bottom: 48px;
        }
        section h2 {
            font-size: 26px;
            margin-bottom: 16px;
        }
        section h3 {
            font-size: 20px;
            margin-top: 28px;
        }
        .tip {
            background: #e0f2fe;
            border-left: 4px solid #0284c7;
            padding: 12px 16px;
            border-radius: 6px;
            margin: 16px 0;
        }
        .steps {
            counter-reset: step;
            list-style: none;
            padding-left: 0;
        }
        .steps li {
            counter-increment: step;
            margin-bottom: 18px;
            position: relative;
            padding-left: 42px;
        }
        .steps li::before {
            content: counter(step);
            position: absolute;
            top: 0;
            left: 0;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: royalblue;
            color: #fff;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
        }
        th, td {
            border: 1px solid #cbd5f5;
            padding: 8px 12px;
            text-align: left;
        }
        th {
            background: #e0e7ff;
        }
        footer {
            border-top: 1px solid #cbd5f5;
            padding: 24px;
            text-align: center;
            color: #334155;
        }
        @media (max-width: 720px) {
            nav ul {
                columns: 1;
            }
            .steps li {
                padding-left: 36px;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Tischreservierung · How-To</h1>
        <p>Diese Seite beschreibt Schritt für Schritt, wie du das Reservierungstool des Sandersdorfer Karnevalsvereins im Arbeitsalltag einsetzt. Alle Funktionen aus dem Hauptwerkzeug sind dokumentiert – von der Veranstaltungsanlage über den Sitzplan bis zu Exporten, Synchronisationen und Rechnungen.</p>
    </header>
    <main>
        <nav aria-label="Inhaltsverzeichnis">
            <h2>Direkt zu …</h2>
            <ul>
                <li><a href="#grundlagen">Grundlagen &amp; Aufbau</a></li>
                <li><a href="#start">Erststart &amp; Veranstaltungen</a></li>
                <li><a href="#einstellungen">Einstellungen &amp; Aktionen</a></li>
                <li><a href="#sitzplan">Sitzplan &amp; Tischverwaltung</a></li>
                <li><a href="#reservierungen">Reservierungen erfassen</a></li>
                <li><a href="#daten">Datenexport &amp; Import</a></li>
                <li><a href="#suche">Suche, Warenkorb &amp; Bearbeitung</a></li>
                <li><a href="#sync">Synchronisation &amp; Zusatzansichten</a></li>
                <li><a href="#verkauf">Verkauf &amp; Rechnungen</a></li>
                <li><a href="#tipps">Tipps &amp; Troubleshooting</a></li>
            </ul>
        </nav>

        <section id="grundlagen">
            <h2>Grundlagen &amp; Aufbau</h2>
            <p>Das Tool besteht aus einem Kopfbereich mit den wichtigsten Schaltern, einem flexiblen Einstellungsmenü (öffnet sich über das Zahnrad-Symbol) und dem Arbeitsbereich mit Tischliste und Reservierungstabelle. Über das Fragezeichen im Einstellungsmenü gelangst du jederzeit wieder auf diese Anleitung. Solange keine Veranstaltung aktiv ist, bleibt das Start-Overlay sichtbar.</p>
            <div class="tip">
                <strong>Barrierefreiheit:</strong> Sämtliche klickbaren Elemente im Tischbereich lassen sich auch per Tastatur steuern. Mit <kbd>Tab</kbd> navigierst du durch die Schaltflächen, <kbd>Enter</kbd> oder <kbd>Leertaste</kbd> wählen Tabellenzeilen und Tischkacheln aus.
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Bereich</th>
                        <th>Funktion</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>App-Header</td>
                        <td>Veranstaltungstabs, Warenkorb, Schnellzugriffe auf Zusatzansichten</td>
                    </tr>
                    <tr>
                        <td>Einstellungsmenü</td>
                        <td>Eventverwaltung, Import/Export, Kartenpreis, Cache-Optionen</td>
                    </tr>
                    <tr>
                        <td>Arbeitsbereich</td>
                        <td>Tischauswahl, Reservierungstabelle, Aktionsknöpfe</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="start">
            <h2>Erststart &amp; Veranstaltungen</h2>
            <h3>Erste Schritte</h3>
            <ol class="steps">
                <li>Öffne <code>index.html</code> im Browser oder starte einen lokalen Webserver (z. B. <code>npx serve</code> im Projektverzeichnis).</li>
                <li>Nutze das Start-Overlay, um<br>• <strong>Neue Veranstaltung anlegen</strong> – öffnet den Dialog zur Datums- &amp; Typwahl.<br>• <strong>Veranstaltung importieren</strong> – wählt direkt eine JSON-Datei und erzeugt daraus einen neuen Tab.<br>• <strong>Aus Cache laden</strong> – zeigt gespeicherte Browser-Snapshots und stellt sie mit einem Klick wieder her.</li>
                <li>Beim Anlegen fragt der Dialog nach Datum und Veranstaltungsart. Der vorgeschlagene Dateiname folgt dem Muster <code>YYYY-MM-DD_TYP.json</code>. Bestätige mit <em>Anlegen</em>.</li>
            </ol>
            <h3>Veranstaltungen verwalten</h3>
            <ul>
                <li>Die Tabs erscheinen doppelt: im Kopfbereich und im Einstellungsmenü. Ein Klick wechselt die Veranstaltung.</li>
                <li>Doppelklick auf einen Tab oder der Button <em>Namen ändern</em> öffnet den Umbenennungsdialog mit Datum &amp; Typ.</li>
                <li><em>Anzeigenamen ändern</em> steuert den externen Titel (z. B. für Sync-Ansichten).</li>
                <li><em>Veranstaltung entfernen</em> löscht den aktiven Tab samt Reservierungen nach Bestätigung.</li>
                <li>Das Plus-Symbol blendet ein Menü ein:<br>• <em>Neue Veranstaltung anlegen</em><br>• <em>Veranstaltung importieren</em> (Import direkt nach dem Anlegen)<br>• <em>Aus Cache laden</em> (übernimmt gespeicherte Stände)</li>
                <li>Der Cache kann aus dem Start-Overlay oder über den Button <em>Veranstaltung aus Cache entfernen</em> bereinigt werden.</li>
            </ul>
        </section>

        <section id="einstellungen">
            <h2>Einstellungen &amp; Aktionen</h2>
            <p>Das Zahnrad-Symbol öffnet das Einstellungsmenü. Es bleibt fokussierbar und lässt sich mit <kbd>Esc</kbd> wieder schließen.</p>
            <ul>
                <li><strong>Hilfebutton (? Symbol):</strong> Öffnet diese How-To-Seite in einem neuen Tab.</li>
                <li><strong>Sitzplätze exportieren (JSON):</strong> Speichert den aktuellen Saalplan inklusive Positionen und Gang-Informationen.</li>
                <li><strong>Sitzplätze importieren:</strong> Lädt eine zuvor exportierte Tischkonfiguration. Bestehende Tische werden ersetzt.</li>
                <li><strong>Reservierungen exportieren (JSON):</strong> Erstellt eine Datei mit allen Reservierungen, Preisen und Rechnungsdaten.</li>
                <li><strong>Reservierungen importieren:</strong> Importiert komplette Veranstaltungssnapshots. Nach erfolgreichem Import wird automatisch neu gerendert.</li>
                <li><strong>Veranstaltung aus Cache entfernen:</strong> Löscht den Browser-Zwischenspeicher für den aktiven Tab.</li>
            </ul>
            <h3>Werte bearbeiten</h3>
            <ul>
                <li><strong>Kartenpreis bearbeiten:</strong> Stiftsymbol anklicken, neuen Preis (z. B. <code>22</code> oder <code>22,00</code>) eingeben. Der Betrag wird automatisch formatiert.</li>
                <li><strong>Veranstaltungsname:</strong> Zeigt den Dateinamen. Über <em>Namen ändern</em> lässt er sich anpassen.</li>
                <li><strong>Anzeigename (extern):</strong> Frei wählbarer Titel für Sync-Tabs und Rechnungen.</li>
            </ul>
        </section>

        <section id="sitzplan">
            <h2>Sitzplan &amp; Tischauswahl</h2>
            <p>Die linke Tischübersicht listet alle verfügbaren Tische inklusive verbleibender Plätze. Ein Klick (oder <kbd>Enter</kbd> / <kbd>Leertaste</kbd>) markiert den Tisch und zeigt rechts alle Reservierungen.</p>
            <div class="tip">
                <strong>Schneller Wechsel:</strong> Das Dropdown <em>Bitte Tisch auswählen</em> synchronisiert sich mit den Tischkacheln. Änderungen lösen automatisch ein UI-Update aus.</div>
            <h3>Tische anpassen</h3>
            <ul>
                <li><strong>Sitzplatzanzahl ändern:</strong> Öffnet das Modal „Tische &amp; Sitzplätze bearbeiten“. Hier kannst du pro Tisch Kapazität, Position (links/mittig/rechts/stehend) und angrenzenden Gang festlegen.</li>
                <li><strong>Tisch hinzufügen:</strong> Innerhalb des Modals fügt der Button automatisch die nächste freie Tischnummer mit Standardplätzen hinzu.</li>
                <li><strong>Tisch entfernen:</strong> Entfernt den höchsten Tisch. Bei vorhandenen Reservierungen erscheint eine Sicherheitsabfrage.</li>
                <li><strong>Speichern:</strong> Übernimmt alle Änderungen sofort, aktualisiert die Tischauswahl und synchronisiert Zusatzansichten.</li>
            </ul>
        </section>

        <section id="reservierungen">
            <h2>Reservierungen erfassen</h2>
            <h3>Standard-Buchung</h3>
            <ol class="steps">
                <li>Klicke auf <em>Reservierung berechnen</em>.</li>
                <li>Gib Name, Kartenanzahl und optional einen Tischwunsch an.</li>
                <li>Das System sucht automatisch passende freie Plätze, verteilt ggf. auf mehrere Tische, und markiert die betroffenen Tische.</li>
                <li>Im Anschluss erscheint eine Zusammenfassung sowie die aktualisierte Reservierungsliste.</li>
            </ol>
            <h3>Nachträgliche Bearbeitung</h3>
            <ul>
                <li><strong>Bearbeiten:</strong> Stiftsymbol anklicken, neue Kartenanzahl eingeben. Das System prüft automatisch, ob noch Plätze frei sind.</li>
                <li><strong>Notiz hinzufügen:</strong> Sprechblasen-Symbol verwenden, um Hinweise wie Allergien oder Zahlungsstatus zu hinterlegen.</li>
                <li><strong>Verschieben / Tauschen:</strong> Pfeil-Symbol öffnet das Modal zum Verschieben oder Tauschen. Es zeigt Quellen- und Zieltabellen mit frei wählbarer Kartenanzahl.</li>
                <li><strong>In den Warenkorb:</strong> Einkaufswagen-Symbol legt die Reservierung für den Verkauf bereit.</li>
                <li><strong>Als verkauft markieren:</strong> Häkchen-Symbol kennzeichnet die Reservierung als abgeschlossen (ohne Warenkorb).</li>
                <li><strong>Verkauf zurücksetzen:</strong> Rückgängig-Symbol hebt den Verkauf wieder auf.</li>
                <li><strong>Aus dem Warenkorb entfernen:</strong> Durchgestrichenes Einkaufswagen-Symbol entfernt die Reservierung aus dem aktuellen Verkauf.</li>
                <li><strong>Löschen:</strong> Das Papierkorb-Symbol entfernt Einträge und gibt Plätze wieder frei.</li>
            </ul>
            <p>Alle Aktionen aktualisieren sofort den lokalen Datenbestand und markieren die Veranstaltung als „dirty“, wodurch Exporte und Synchronisationen erkennen, dass neue Daten vorliegen.</p>
        </section>

        <section id="daten">
            <h2>Datenexport &amp; Import</h2>
            <ul>
                <li><strong>Sitzplätze exportieren (JSON):</strong> Sichere vor Umbauten den Saalplan, um ihn später wiederherzustellen.</li>
                <li><strong>Sitzplätze importieren:</strong> Ideal, wenn unterschiedliche Saalpläne (z. B. Fasching vs. Narrengipfel) genutzt werden.</li>
                <li><strong>Reservierungen exportieren (JSON):</strong> Vollständiges Backup inklusive Kartenpreis, Rechnungen, Notizen und Split-Informationen.</li>
                <li><strong>Reservierungen importieren:</strong> Stellt komplette Veranstaltungen wieder her. Nach dem Import erscheinen alle Daten inklusive Warenkorb- &amp; Verkaufsstatus.</li>
                <li><strong>Cache-Tipps:</strong> Nutze den Browser-Cache für schnelle Zwischenstände, exportiere aber zusätzlich regelmäßig JSON-Dateien.</li>
            </ul>
        </section>

        <section id="suche">
            <h2>Suche, Warenkorb &amp; Bearbeitung</h2>
            <p>Der Button <strong>Buchungen suchen</strong> öffnet eine filterbare Liste über alle Veranstaltungen.</p>
            <ul>
                <li>Suche nach Namen oder Booking-ID. Optional lässt sich die Veranstaltung eingrenzen.</li>
                <li>Jede Zeile bietet dieselben Aktionen wie die Reservierungstabelle (Bearbeiten, Verschieben, Warenkorb, Verkauf zurücknehmen, Löschen).</li>
                <li>Über die Warenkorbsymbole können Reservierungen auch veranstaltungsübergreifend in den Verkauf übernommen werden.</li>
            </ul>
            <p>Der Warenkorb-Button im Kopfbereich zeigt die Anzahl der ausgewählten Reservierungen. Ein Klick öffnet das Verkaufsmodal.</p>
            <ul>
                <li>Innerhalb des Warenkorbs können Reservierungen erneut bearbeitet, verschoben, gelöscht oder aus dem Warenkorb entfernt werden.</li>
                <li>Die Gesamtsumme berechnet sich automatisch aus Kartenanzahl &times; Kartenpreis.</li>
                <li>Mit <strong>Verkauf abschließen</strong> startest du den Zahlungsablauf.</li>
            </ul>
        </section>

        <section id="sync">
            <h2>Synchronisation &amp; Zusatzansichten</h2>
            <p>Das System nutzt <code>BroadcastChannel</code> und einen lokalen Speicher-Fallback, um Daten mit weiteren Browser-Tabs zu teilen. Die folgenden Buttons öffnen Spezialansichten in neuen Tabs. Halte diese Seiten parallel offen, um Live-Updates zu erhalten.</p>
            <ul>
                <li><strong>Internen Saalplan öffnen:</strong> Detailansicht für das Team mit Farbmarkierungen, verbleibenden Plätzen, Notizen und Split-Hinweisen.</li>
                <li><strong>Externen Saalplan öffnen:</strong> Öffentlich nutzbare Übersicht mit Fokus auf freie Plätze und Anzeigenamen.</li>
                <li><strong>Kundendisplay öffnen:</strong> Kundenansicht mit Fortschrittsleiste, QR-Code zum Rechnungsdownload und Statusmeldungen. Der Button <em>Nächster Kunde</em> im Abschlussmodal setzt die Anzeige zurück.</li>
            </ul>
            <div class="tip">
                <strong>Synchronität:</strong> Solange alle Tabs im selben Browser laufen, werden Änderungen nahezu in Echtzeit gespiegelt. Der LocalStorage-Fallback greift automatisch, wenn <code>BroadcastChannel</code> nicht verfügbar ist.</div>
        </section>

        <section id="verkauf">
            <h2>Verkauf &amp; Rechnungen</h2>
            <ol class="steps">
                <li>Öffne den Warenkorb und kontrolliere die ausgewählten Reservierungen.</li>
                <li>Klicke auf <strong>Verkauf abschließen</strong>. Wähle anschließend im Zahlungsdialog <em>Barzahlung</em> oder <em>Kartenzahlung</em>.</li>
                <li>Nach Bestätigung erstellt das System automatisch Rechnungs-PDFs, markiert die Reservierungen als verkauft und zeigt das Abschlussmodal.</li>
            </ol>
            <ul>
                <li><strong>Rechnung herunterladen:</strong> Der Button im Abschlussmodal lädt das PDF der zuletzt abgeschlossenen Bestellung.</li>
                <li><strong>Nächster Kunde:</strong> Schließt alle Modale, setzt das Kundendisplay zurück und startet den nächsten Verkaufsvorgang.</li>
                <li><strong>Rechnungen als ZIP herunterladen:</strong> Der separate Button auf der Startseite sammelt alle vorhandenen Rechnungen in einer ZIP-Datei.</li>
                <li><strong>Verkauf rückgängig:</strong> Über die Aktionen „Verkauf zurücksetzen“ in Tabelle, Suche oder Warenkorb lassen sich Verkäufe wieder öffnen.</li>
            </ul>
        </section>

        <section id="tipps">
            <h2>Tipps &amp; Troubleshooting</h2>
            <ul>
                <li><strong>Browser-Cache leeren:</strong> Bei Anzeigeproblemen die Funktion „Veranstaltung aus Cache entfernen“ nutzen oder den Browser-Cache komplett leeren.</li>
                <li><strong>Backup-Strategie:</strong> Nach jedem Verkaufstag sowohl Sitzplätze als auch Reservierungen exportieren. So kannst du den Stand jederzeit rekonstruieren.</li>
                <li><strong>Fehlende BroadcastChannel-Unterstützung:</strong> Ältere Browser synchronisieren ausschließlich über LocalStorage. In diesem Fall Tabs kurz neu laden.</li>
                <li><strong>Importfehler:</strong> Prüfe, ob die JSON-Datei die Felder <code>tisch</code> und <code>reservationsByTable</code> enthält und nicht manuell verändert wurde.</li>
                <li><strong>Rechnung fehlt:</strong> Stelle sicher, dass der Verkauf über den Warenkorb abgeschlossen und eine Zahlungsart gewählt wurde.</li>
                <li><strong>Kundendisplay reagiert nicht:</strong> Betätige <em>Nächster Kunde</em> und lade die Anzeige bei Bedarf neu.</li>
            </ul>
        </section>
    </main>
    <footer>
        Stand: <time datetime="2024-06-15">Juni 2024</time> · Für Rückfragen bitte an das Entwicklerteam oder den Technikverantwortlichen wenden.
    </footer>
</body>
</html>
